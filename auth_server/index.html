<!DOCTYPE html>
<html>
<head>
	<title>Auth</title>
	<meta charset="utf-8">
	<style type=text/css>
		body {
			display: flex;
			flex-direction: column;
			font-family: Tahoma, Verdana, sans-serif;
		}
		fieldset {
			max-width: 20em;
			display: flex;
			flex-direction: column;
			align-content: space-between;
		}
		label {
			margin: 0.2em;
		}
		input {
			margin-bottom: 0.5em;
		}
	</style>
	<script>
		function init() {
			useFormAsSignIn();
			for (var i = 0, radios = document.getElementsByName("logintype"); i < radios.length; i++) {
			 	radios[i].addEventListener("change", function(event){
			 		if (this.value == "signin") useFormAsSignIn();
			 		else useFormAsSignUp();
			 	});
			 	if (i == 0) radios[i].checked = true;
			 	else radios[i].checked = false;
			}
		}

		function useFormAsSignIn() {
 			document.getElementById("legend").textContent = "Sign in / Login";
 			document.getElementById("username").textContent = "Username or email:";
 			for (var j = 0, emails = document.getElementsByClassName("email"); j < emails.length; j++) {
 				emails[j].setAttribute("hidden", true);
 				if (j == 1) emails[j].removeAttribute("required");
 			}
 			//form.removeEventListener("submit");
 			form.addEventListener("submit", signin);
		}

		function useFormAsSignUp() {
			document.getElementsByTagName("legend")[0].textContent = "Sign up / Register";
 			document.getElementById("username").textContent = "Username:"
 			for (var j = 0, emails = document.getElementsByClassName("email"); j < emails.length; j++) {
 				emails[j].removeAttribute("hidden");
 				if (j == 1) emails[j].setAttribute("required", true);
 			}
 			//form.removeEventListener("submit");
 			form.addEventListener("submit", signup)
 		
		}

		function signin(event) {
			event.preventDefault();
			fetch("/signin", {
				method: "POST",
				headers:{
					"Content-Type": "application/json"
				},
				body: JSON.stringify({
					login: form.username.value,
					password: form.password.value
				})
			}).then(function(res){
				console.log(res)
			});
		}
		function signup(event) {
			event.preventDefault();
			fetch("/signup", {
				method: "POST",
				headers:{
					"Content-Type": "application/json"
				},
				body: JSON.stringify({
					username: form.username.value,
					email: form.email.value,
					password: form.password.value
				})
			}).then(function(res){
				console.log(res)
			});
		}
	</script>
</head>
<body onload="init()">
	<form id=form name=form action="#">
		<fieldset>
			<legend id="legend">Sign in / Login</legend>
			<p>
				<input type=radio id=signin name=logintype value=signin checked>
				<label for=signin>Sign in / Login</label><br>
				<input type=radio id=signup name=logintype value=signup>
				<label for=signup>Sign up / Register</label>
			</p>
			<label class=username for=username id=username>Username or email:</label>
			<input class=username type=text name=username required=true>
			<label class=email for=email hidden>Email:</label>
			<input class=email type=text name=email hidden>
			<label class=password for=password>Password:</label>
			<input class=password type=password name=password required=true>
			<input type=submit>
		</fieldset>
	</form>
</body>
</html>